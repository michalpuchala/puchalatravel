{% extends 'blog/base.html' %}
{% load static %}

{% block meta %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Puchała Travel blog - homepage">
    <meta name="keywords" content="travel,blog,photography">
    <meta name="author" content="Michał Puchała, Magdalena Puchała">
{% endblock %}
{% block header %}
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.css' rel='stylesheet'/>
{% endblock %}
{% block banner %}
    <section class="banner">
        <div class="banner-inner">
            <img id="mobile-image" src="{% static 'pictures/top_background.jpg' %}">
        </div>
        <h2>
            <a href="{% url 'posts' %}">blog</a>
        </h2>
    </section>
{% endblock %}
{% block three_columns %}
<section class="one-third" id="post-1-main">
    <div class="post-container">
        <a href="{{ latest_post.get_absolute_url }}"><img src="{{ latest_post.main_image.picture.url }}">
        <div class="post-title">
            {% if LANGUAGE_CODE == 'pl' %}
                <div id="title-post">{{ latest_post.title_pl }}</div>
            {% else %}
                <div id="title-post">{{ latest_post.title }}</div>
            {% endif %}
            <div id="post-date">{{ latest_post_date }}</div>
            {% if LANGUAGE_CODE == 'pl' %}
                <div id="post-place">{{ latest_post.byline_pl|safe }}</div>
            {% else %}
                <div id="post-place">{{ latest_post.byline|safe }}</div>
            {% endif %}
        </div>
        </a>
    </div>
</section>
<section class="one-third" id="post-2-main">
    <div class="post-container">
        <a href="{{ second_latest_post.get_absolute_url }}"><img src="{{ second_latest_post.main_image.picture.url }}">
        <div class="post-title">
            {% if LANGUAGE_CODE == 'pl' %}
                <div id="title-post">{{ second_latest_post.title_pl }}</div>
            {% else %}
                <div id="title-post">{{ second_latest_post.title }}</div>
            {% endif %}
            <div id="post-date">{{ second_latest_post_date }}</div>
            {% if LANGUAGE_CODE == 'pl' %}
                <div id="post-place">{{ second_latest_post.byline_pl|safe }}</div>
            {% else %}
                <div id="post-place">{{ second_latest_post.byline|safe }}</div>
            {% endif %}
        </div>
        </a>
    </div>
</section>
<section class="one-third" id="post-3-main">
    <div class="post-container">
        <a href="{{ third_latest_post.get_absolute_url }}"><img src="{{ third_latest_post.main_image.picture.url }}">
        <div class="post-title">
            {% if LANGUAGE_CODE == 'pl' %}
                <div id="title-post">{{ third_latest_post.title_pl }}</div>
            {% else %}
                <div id="title-post">{{ third_latest_post.title }}</div>
            {% endif %}
            <div id="post-date">{{ third_latest_post_date }}</div>
            {% if LANGUAGE_CODE == 'pl' %}
                <div id="post-place">{{ third_latest_post.byline_pl|safe }}</div>
            {% else %}
                <div id="post-place">{{ third_latest_post.byline|safe }}</div>
            {% endif %}
        </div>
        </a>
    </div>
</section>
{% endblock %}

{% block two_columns %}
<section class="inner-wrapper">
    <article id="about-us">
        <a href="{% url 'about_us' %}"><img id="mobile-image" src="{% static 'pictures/about_us.jpg' %}"></a>
    </article>
    <aside id="about-us">
        {% if LANGUAGE_CODE == 'pl' %}
            <h2><a href="{% url 'about_us' %}">o nas</a></h2>
            <p id="about-us-p">Pierwszą wspólną podróż odbyliśmy w 2010. Odkąd Magda wyjechała na Erasmusa po raz pierwszy,
                zaczęliśmy częściej latać i tak już zostało. W 2015 naszą bazą została Barcelona, gdzie obydwoje pracujemy.
                Żeby pogodzić pełen etat i nienasyconą żądzę odwiedzania coraz to nowych miejsc, musieliśmy zostać ekspertami
                optymalizacji dni wolnych. Jesteśmy uzależnieni od newslettera Fly4Free i najczęściej decydujemy się podróżować
                tam, gdzie pojawia się dobra oferta.</p>
            <p id="about-us-p">Nasze podróże kręcą się wokół pięknych miejsc (im mniej turystyczne tym lepiej), amatorskiej
                fotografii i dobrego jedzenia. Staramy się osiągać w nich kompromis między uzależnieniem Magdy od świeżych
                hotelowych ręczników i przekonaniem Michała, że należy trzymać się budżetu :)</p>
            <p id="about-us-p">Ten blog to nasze zapiski z podróży, powód, dla którego warto spędzać godziny w Lightroomie
                i miejsce do dzielenia się wskazówkami z tymi, którzy planują odwiedzać miejsca które my już widzieliśmy.
                Jeśli chcecie podróżować, ale nie macie nieograniczonych funduszy ani dni wolnych, ten blog jest dla Was!</p>
        {% else %}
            <h2><a href="{% url 'about_us' %}">about us</a></h2>
            <p id="about-us-p">We got addicted to travelling about seven years ago, when Magda moved to Spain for the first time.
                We would travel to see each other at least once a month and then we just couldn’t stop.
                Both of us have a full time job in Barcelona, so we had to become experts in optimising holidays.
                We’re hooked on Fly4free newsletter and try to travel where a good deal takes us.</p>
                <p id="about-us-p">Our trips are about nice places, photography and good food, trying always to compromise between Magda’s love for
                the fresh towels in hotels and Michał’s budgetary concerns :) This blog is meant to be our travel journal, a motivation
                to improve our photography skills and a place to share with those who consider visiting places we’ve seen.</p>
                <p id="about-us-p">If you love to travel comfortably but don't have unlimited budget nor vacation days, this blog is for you!
            </p>
        {% endif %}
    </aside>
</section>
<section class="inner-wrapper-2">
    <article id="travel-challenge">
        {% if LANGUAGE_CODE == 'pl' %}
        <h2><a href="{% url 'map' %}">ślubne wyzwanie</a></h2>
        <p id="about-us-p">Na naszym weselu ponad rok temu, poprosiliśmy gości żeby zamiast życzeń podzielili się z nami
            najpiękniejszymi miejscami, które udało im się odwiedzić; i zobowiązaliśmy się zobaczyć je wszystkie. Mamy
            wrażenie, że nie wszyscy podeszli do tematu na serio (vel trzeźwo ;)) ale i tak planujemy zaliczyć każde miejsce
            z naszej ślubnej mapy. Praca wre!</p>
        {% else %}
        <h2><a href="{% url 'map' %}">the travel challenge</a></h2>
        <p id="about-us-p">When people get married, they usually get good wishes. For us, the best wish is to go to places
            we would fall in love with, so we asked our wedding guests to share the most beautiful places they have ever
            seen and we promised to visit every one of them. We’re not sure the guests were entirely serious (or sober ;))
            about them but the promise stands, we’re trying to visit them all. Challenge in progress!</p>
        {% endif %}
        <a href="{% url 'map' %}#legend-visited">
            <div id="progressbar">
                <div>26%</div>
            </div>
        </a>
        <div class="map-legend">
            <span id="legend-visited">&#x25CF;</span> {% if LANGUAGE_CODE == 'pl' %} zaliczone&nbsp;&nbsp; {% else %} visited&nbsp;&nbsp;{% endif %}
            <span id="legend-planned">&#x25CF;</span> {% if LANGUAGE_CODE == 'pl' %} planowane&nbsp;&nbsp; {% else %} planned&nbsp;&nbsp;{% endif %}
            <span id="legend-visited-other">&#x25CF;</span> {% if LANGUAGE_CODE == 'pl' %} inne zaliczone&nbsp;&nbsp; {% else %} other visited&nbsp;&nbsp;{% endif %}
            <span id="legend-next-destination">&#x25CF;</span> {% if LANGUAGE_CODE == 'pl' %} natępna podróż {% else %} next destination&nbsp;{% endif %}
        </div>
    </article>
    <aside>
            <div id='map-index'></div>
           {% if LANGUAGE_CODE == 'pl' %}
                <script>

                mapboxgl.accessToken = 'pk.eyJ1IjoibWljaGFscHVjaGFsYSIsImEiOiJjamxxeWk0ZTYwcWJyM3BwbGVzMWpobjFqIn0.sBxqcK2lDMxn9RvqaBfduw';

                var map = new mapboxgl.Map({
                  container: 'map-index',
                  style: 'mapbox://styles/mapbox/light-v9',
                  center: [0, 20],
                  zoom: 0.5
                });

                // planned
                var geojson_planned = {
                  type: 'FeatureCollection',
                  features: [
                  {% for i in planned_places %}
                    {
                      type: 'Feature',
                      geometry: {
                        type: 'Point',
                        coordinates: [{{ i.coord_h }}, {{ i.coord_v }}]
                      },
                      properties: {
                        title: "<div class='place-title'>{{ i.name_pl }}</div>",
                        description: "<div class='place-post'>{% for post in i.posts.all %}<a href='{{ post.get_absolute_url }}'>{{ post.title_pl }}</a><br/>{% endfor %}</div>"
                      }
                    },
                  {% endfor %}
                ]
                };

                // add markers to map
                geojson_planned.features.forEach(function(marker) {

                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker-light-red';

                // visited
                new mapboxgl.Marker(el)
                .setLngLat(marker.geometry.coordinates)
                .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                .setHTML(marker.properties.title + marker.properties.description))
                .addTo(map);
                });

                var geojson_visited = {
                  type: 'FeatureCollection',
                  features: [
                  {% for i in visited_places %}
                    {
                      type: 'Feature',
                      geometry: {
                        type: 'Point',
                        coordinates: [{{ i.coord_h }}, {{ i.coord_v }}]
                      },
                      properties: {
                        title: "<div class='place-title'>{{ i.name_pl }}</div>",
                        description: "<div class='place-post'>{% for post in i.posts.all %}<a href='{{ post.get_absolute_url }}'>{{ post.title_pl }}</a><br/>{% endfor %}</div>"
                      }
                    },
                  {% endfor %}
                ]
                };

                // add markers to map
                geojson_visited.features.forEach(function(marker) {

                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker-light-green';

                // planned wedding
                new mapboxgl.Marker(el)
                .setLngLat(marker.geometry.coordinates)
                .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                .setHTML(marker.properties.title + marker.properties.description))
                .addTo(map);
                });

                var geojson_planned_wedding = {
                  type: 'FeatureCollection',
                  features: [
                  {% for i in planned_wedding_places %}
                    {
                      type: 'Feature',
                      geometry: {
                        type: 'Point',
                        coordinates: [{{ i.coord_h }}, {{ i.coord_v }}]
                      },
                      properties: {
                        title: "<div class='place-title'>{{ i.name_pl }}</div>",
                        description: "<div class='place-post'>{% for post in i.posts.all %}<a href='{{ post.get_absolute_url }}'>{{ post.title_pl }}</a><br/>{% endfor %}</div>"
                      }
                    },
                  {% endfor %}
                ]
                };

                // add markers to map
                geojson_planned_wedding.features.forEach(function(marker) {

                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker-red';

                // visited_wedding
                new mapboxgl.Marker(el)
                .setLngLat(marker.geometry.coordinates)
                .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                .setHTML(marker.properties.title + marker.properties.description))
                .addTo(map);
                });

                var geojson_visited_wedding = {
                  type: 'FeatureCollection',
                  features: [
                  {% for i in visited_wedding_places %}
                    {
                      type: 'Feature',
                      geometry: {
                        type: 'Point',
                        coordinates: [{{ i.coord_h }}, {{ i.coord_v }}]
                      },
                      properties: {
                        title: "<div class='place-title'>{{ i.name_pl }}</div>",
                        description: "<div class='place-post'>{% for post in i.posts.all %}<a href='{{ post.get_absolute_url }}'>{{ post.title_pl }}</a><br/>{% endfor %}</div>"
                      }
                    },
                  {% endfor %}
                ]
                };

                // add markers to map
                geojson_visited_wedding.features.forEach(function(marker) {

                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker-green';

                // make a marker for each feature and add to the map
                new mapboxgl.Marker(el)
                .setLngLat(marker.geometry.coordinates)
                .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                .setHTML(marker.properties.title + marker.properties.description))
                .addTo(map);
                });

                </script>
           {% else %}
                <script>

                mapboxgl.accessToken = 'pk.eyJ1IjoibWljaGFscHVjaGFsYSIsImEiOiJjamxxeWk0ZTYwcWJyM3BwbGVzMWpobjFqIn0.sBxqcK2lDMxn9RvqaBfduw';

                var map = new mapboxgl.Map({
                  container: 'map-index',
                  style: 'mapbox://styles/mapbox/light-v9',
                  center: [0, 20],
                  zoom: 0.5
                });

                // planned
                var geojson_planned = {
                  type: 'FeatureCollection',
                  features: [
                  {% for i in planned_places %}
                    {
                      type: 'Feature',
                      geometry: {
                        type: 'Point',
                        coordinates: [{{ i.coord_h }}, {{ i.coord_v }}]
                      },
                      properties: {
                        title: "<div class='place-title'>{{ i.name }}</div>",
                        description: "<div class='place-post'>{% for post in i.posts.all %}<a href='{{ post.get_absolute_url }}'>{{ post.title }}</a><br/>{% endfor %}</div>"
                      }
                    },
                  {% endfor %}
                ]
                };

                // add markers to map
                geojson_planned.features.forEach(function(marker) {

                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker-light-red';

                // visited
                new mapboxgl.Marker(el)
                .setLngLat(marker.geometry.coordinates)
                .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                .setHTML(marker.properties.title + marker.properties.description))
                .addTo(map);
                });

                var geojson_visited = {
                  type: 'FeatureCollection',
                  features: [
                  {% for i in visited_places %}
                    {
                      type: 'Feature',
                      geometry: {
                        type: 'Point',
                        coordinates: [{{ i.coord_h }}, {{ i.coord_v }}]
                      },
                      properties: {
                        title: "<div class='place-title'>{{ i.name }}</div>",
                        description: "<div class='place-post'>{% for post in i.posts.all %}<a href='{{ post.get_absolute_url }}'>{{ post.title }}</a><br/>{% endfor %}</div>"
                      }
                    },
                  {% endfor %}
                ]
                };

                // add markers to map
                geojson_visited.features.forEach(function(marker) {

                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker-light-green';

                // planned wedding
                new mapboxgl.Marker(el)
                .setLngLat(marker.geometry.coordinates)
                .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                .setHTML(marker.properties.title + marker.properties.description))
                .addTo(map);
                });

                var geojson_planned_wedding = {
                  type: 'FeatureCollection',
                  features: [
                  {% for i in planned_wedding_places %}
                    {
                      type: 'Feature',
                      geometry: {
                        type: 'Point',
                        coordinates: [{{ i.coord_h }}, {{ i.coord_v }}]
                      },
                      properties: {
                        title: "<div class='place-title'>{{ i.name }}</div>",
                        description: "<div class='place-post'>{% for post in i.posts.all %}<a href='{{ post.get_absolute_url }}'>{{ post.title }}</a><br/>{% endfor %}</div>"
                      }
                    },
                  {% endfor %}
                ]
                };

                // add markers to map
                geojson_planned_wedding.features.forEach(function(marker) {

                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker-red';

                // visited_wedding
                new mapboxgl.Marker(el)
                .setLngLat(marker.geometry.coordinates)
                .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                .setHTML(marker.properties.title + marker.properties.description))
                .addTo(map);
                });

                var geojson_visited_wedding = {
                  type: 'FeatureCollection',
                  features: [
                  {% for i in visited_wedding_places %}
                    {
                      type: 'Feature',
                      geometry: {
                        type: 'Point',
                        coordinates: [{{ i.coord_h }}, {{ i.coord_v }}]
                      },
                      properties: {
                        title: "<div class='place-title'>{{ i.name }}</div>",
                        description: "<div class='place-post'>{% for post in i.posts.all %}<a href='{{ post.get_absolute_url }}'>{{ post.title }}</a><br/>{% endfor %}</div>"
                      }
                    },
                  {% endfor %}
                ]
                };

                // add markers to map
                geojson_visited_wedding.features.forEach(function(marker) {

                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker-green';

                // make a marker for each feature and add to the map
                new mapboxgl.Marker(el)
                .setLngLat(marker.geometry.coordinates)
                .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                .setHTML(marker.properties.title + marker.properties.description))
                .addTo(map);
                });

                </script>
           {% endif %}
    </aside>
</section>
{% endblock %}