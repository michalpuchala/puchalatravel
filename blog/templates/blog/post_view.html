{% extends 'blog/base.html' %}

{% load hitcount_tags %}
{% get_hit_count_js_variables for post as hitcount %}

{% block header %}
    <!-- Mapbox -->
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.css' rel='stylesheet'/>
    <!-- Pinterest -->
    <script type="text/javascript">
        (function(d){
            var f = d.getElementsByTagName('SCRIPT')[0], p = d.createElement('SCRIPT');
            p.type = 'text/javascript';
            p.async = true;
            p.src = '//assets.pinterest.com/js/pinit.js';
            f.parentNode.insertBefore(p, f);
        }(document));
    </script>
    <script async defer data-pin-hover="true" src="//assets.pinterest.com/js/pinit.js"></script>
{% endblock %}

{% block banner %}
    <div id='clear-top'></div>
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.2"></script>
{% endblock %}

{% block one_column %}
<div id='post-title'>
    {{ post.title }} <br>
</div>
<div class='post-body'>
    {{ post.text|safe }} <br><br>
</div>
<div id='post-details'>
    <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-via="puchalatravel" data-related="puchalatravel" data-show-count="false">Tweet</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    &nbsp;&nbsp;
    <div class="fb-share-button" data-href="{{ post.facebook_link }}" data-layout="button" data-size="small">
    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fabc.com%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">Share</a></div>
    <br>
Author: {{ post.author.first_name }}, published: {{ post.published_date|date:'Y-m-d' }}
</div>
<div class='post-likes'>
    {{ hitcount.total_hits }} views | {{ post.post_likes.count }} likes
    <div id="like-btn"><a href = "{{ post.get_like_url }}">Like</a></div><br>
</div>
<div class='post-comments'>
    {% for comment in post.comments.all %}
        <div id="comment">
            <strong>{{ comment.author }}  </strong><div id="date"> | {{ comment.created_date|date:'Y-m-d, H:i' }}</div>
            <div id="comment-text">{{ comment.text|linebreaks }}</div>
        </div>
    {% empty %}
        <div id="comment">
            <div id="comment-text">No comments here yet :(</div>
        </div>
    {% endfor %}
    <div id="add-comment"><a href="{% url 'add_comment_to_post' pk=post.pk %}">
        <button class="form-button" type="submit">Add comment</button>
    </a></div>
</div>
{% endblock %}